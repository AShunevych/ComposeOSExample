name: Run tests
on: 
  workflow_dispatch:
    inputs:
      task:
        description: 'task to run'
        required: false
        default: 'watch-ui-tests'


jobs:
  run-tests:
   runs-on: ubuntu-latest
   steps:
     - name: Checkout 
       uses: actions/checkout@v3
     
     - name: Set Up JDK
       uses: actions/setup-java@v3
       with:
        distribution: 'corretto'
        java-version: '11'

     - name: Change wrapper permissions
       run: chmod +x ./gradlew
       
      # Create APK Debug
     - name: Build apk debug project (APK)
       run: ./gradlew assembleDebug

     # Create APK Debug
     - name: Build apk debug test project (APK)
       run: ./gradlew assembleAndroidTest

     - name: Upload results
       uses: actions/upload-artifact@v4
       with:
          name: APKs-${{ inputs.task }}
          path: app/build/outputs/apk/

     - name: Artifact status
       uses: xSAVIKx/artifact-exists-action@v0
       with:
         name: "APKs-${{ inputs.task }}"
        
     # - name: Run tests
     #   uses: MarathonLabs/action-test@01
     #   with:
     #    apiKey: 8qWrAp8NJZzrd0h7RkKBuVJRTVMlola60Lf9
     #    version: 1
     #    application: app/build/outputs/apk/debug/app-debug.apk
     #    testApplication: app/build/outputs/apk/androidTest/debug/app-debug-androidTest.apk
     #    platform: Android
     #    device: Watch
        
